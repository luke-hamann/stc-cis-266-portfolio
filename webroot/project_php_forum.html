<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forum Website</title>
    <link rel="stylesheet" href="theme.css">
</head>
<body>
    <header class="header">
        <nav class="header-nav">
            <ul class="header-ul">
                <li class="header-li">
                    <a href=".">Home</a>
                </li>
                <li class="header-li">
                    <a href="LukeHamannResume.pdf">Resume.pdf</a>
                </li>
                <li class="header-li">
                    <a href="CIS_Syllabi.html">CIS Syllabi</a>
                </li>
                <li class="header-li">
                    <details>
                        <summary>Projects</summary>
                        <ul>
                            <li><a href="project_java_product_manager.html">Product Line Item Manager</a></li>
                            <li><a href="project_c_sharp_sportspro.html">SportsPro Technical Support Website</a></li>
                            <li><a href="project_php_weather_app.html">Weather App</a></li>
                            <li><a href="project_php_forum.html">Forum Website</a></li>
                            <li><a href="project_web_services_unit_2_ex_3.html">RESTful AJAJ Service and Testers</a></li>
                            <li><a href="project_web_services_scrum_3.html">Car Dealership Data Website</a></li>
                            <li><a href="project_web_services_unit_3_ex_2.html">Products SOAP API with Database Emulator</a></li>
                            <li><a href="project_web_services_scrum_4.html">Cats SOAP API</a></li>
                        </ul>
                    </details>
                </li>
            </ul>
        </nav>
    </header>
    <main class="cis-syllabi">
        <h1>Forum Website</h1>
        <p>
            This project is a discussion website with multiple forums.
            Users can login to post and comment.
            Several administrative functions are also available, including managing user accounts and changing passwords.
            The code follows a highly modular, MVC design pattern.
            It was created individually as a PHP final project.
        </p>
        <p>
            The technologies included:
        </p>
        <ul>
            <li>PHP</li>
            <li>MySQL</li>
            <li>Bootstrap</li>
        </ul>
        <p>
            The approach included:
        </p>
        <ul>
            <li>Analyzing the application specifications</li>
            <li>Designing the database</li>
            <li>Planning and designing all components within the MVC architecture</li>
            <li>Implementing the database, models, controllers, views, authentication, and authorization</li>
            <li>Testing and debugging the application</li>
            <li>Documenting the solution</li>
        </ul>
        <p>
            The development tools included:
        </p>
        <ul>
            <li>Visual Studio Code</li>
            <li>phpMyAdmin</li>
            <li>WampServer</li>
        </ul>
        <p>
            This application is available as a live demo.
            Please contact me to request credentials and try it out.
        </p>
        <p>
            <a href="https://forum.luke.hamann.me/" class="live-demo-button">&#x25B6; Live Demo</a>
        </p>
        <h2>Screenshots</h2>
        <figure>
            <img src="media/php_forum/main.png">
            <figcaption>The home page with a list of recent posts across all forums</figcaption>
        </figure>
        <figure>
            <img src="media/php_forum/post.png">
            <figcaption>The post page for viewing a post and adding comments</figcaption>
        </figure>
        <figure>
            <img src="media/php_forum/profile.png">
            <figcaption>The user profile page for viewing all a user's posts and comments</figcaption>
        </figure>
        <figure>
            <img src="media/php_forum/users_admin.png">
            <figcaption>The users list as viewed by an administrator</figcaption>
        </figure>
        <h2>Code Samples</h2>
        <figure>
            <code><pre>&lt;?php
/**
* Title: Main Controller
* Purpose: To be the entry point where controllers and models are imported,
*          and the request context is prepared
*/

// Import the models
require_once('models/entities/forum.php');
require_once('models/entities/user.php');
require_once('models/entities/post.php');
require_once('models/entities/comment.php');
require_once('models/databases/_database.php');
require_once('models/databases/forumDB.php');
require_once('models/databases/userDB.php');
require_once('models/databases/postDB.php');
require_once('models/databases/commentDB.php');

// Start the session and get the current user
session_start();
if (!isset($_SESSION['userId'])) {
    $_SESSION['userId'] = 0;
}
$currentUser = UserDB::getUser($_SESSION['userId']);

// Get the action and request method
$action = FILTER_INPUT(INPUT_POST, 'action')
    ?? FILTER_INPUT(INPUT_GET, 'action') ?? 'home';
$isGetRequest = ($_SERVER['REQUEST_METHOD'] == 'GET');
$isPostRequest = ($_SERVER['REQUEST_METHOD'] == 'POST');

// Import the controllers
require_once('./controllers/_utilityFunctions.php');
require_once('./controllers/accountController.php');
require_once('./controllers/adminController.php');
require_once('./controllers/homeController.php');
require_once('./controllers/postController.php');

return404();

?&gt;</pre></code>
            <figcaption>The front controller</figcaption>
        </figure>
        <figure>
            <code><pre>&lt;?php include('./views/shared/header.php'); ?&gt;

&lt;?php
if ($model-&gt;mode == 'Add') {
    $formAction = '?action=new';
} else if ($model-&gt;mode == 'Edit') {
    $formAction = '?action=editPost&amp;id=' . $model-&gt;post-&gt;id;
}
?&gt;

&lt;div class=&quot;row my-5&quot;&gt;
    &lt;div class=&quot;col-md-6 offset-md-3&quot;&gt;
        &lt;form action=&quot;&lt;?php echo $formAction; ?&gt;&quot; method=&quot;post&quot;&gt;
            &lt;h1&gt;&lt;?php echo $model-&gt;mode; ?&gt; Post&lt;/h1&gt;
            &lt;?php include('./views/shared/formErrors.php'); ?&gt;
            &lt;div class=&quot;mb-3&quot;&gt;
                &lt;label for=&quot;forumId&quot; class=&quot;form-label&quot;&gt;Forum&lt;/label&gt;
                &lt;select name=&quot;forumId&quot; id=&quot;forumId&quot; class=&quot;form-select&quot;&gt;
                    &lt;option value=&quot;0&quot; &lt;?php echo (isset($model-&gt;post) &amp;&amp; $model-&gt;post-&gt;forumId == 0 ? 'selected' : ''); ?&gt;&gt;-&lt;/option&gt;
                    &lt;?php foreach ($model-&gt;forums as $forum) : ?&gt;
                        &lt;option value=&quot;&lt;?php echo $forum-&gt;id; ?&gt;&quot; &lt;?php echo (isset($model-&gt;post) &amp;&amp; $model-&gt;post-&gt;forumId == $forum-&gt;id ? 'selected' : ''); ?&gt;&gt;
                            &lt;?php echo htmlspecialchars($forum-&gt;name); ?&gt;
                        &lt;/option&gt;
                    &lt;?php endforeach; ?&gt;
                &lt;/select&gt;
            &lt;/div&gt;
            &lt;div class=&quot;mb-3&quot;&gt;
                &lt;label for=&quot;title&quot; class=&quot;form-label&quot;&gt;Title&lt;/label&gt;
                &lt;input type=&quot;text&quot; name=&quot;title&quot; id=&quot;title&quot; value=&quot;&lt;?php echo (isset($model-&gt;post) ? htmlspecialchars($model-&gt;post-&gt;title) : ''); ?&gt;&quot; class=&quot;form-control&quot; autocomplete=&quot;off&quot; /&gt;
            &lt;/div&gt;
            &lt;div class=&quot;mb-3&quot;&gt;
                &lt;label for=&quot;content&quot; class=&quot;form-label&quot;&gt;Content&lt;/label&gt;
                &lt;textarea name=&quot;content&quot; id=&quot;content&quot; rows=&quot;5&quot; class=&quot;form-control&quot;&gt;&lt;?php echo (isset($model-&gt;post) ? htmlspecialchars($model-&gt;post-&gt;content) : ''); ?&gt;&lt;/textarea&gt;
            &lt;/div&gt;
            &lt;div class=&quot;text-center&quot;&gt;
                &lt;input type=&quot;submit&quot; value=&quot;Submit&quot; class=&quot;btn btn-primary&quot; /&gt;
                &lt;a href=&quot;&lt;?php echo ($model-&gt;mode == 'Add' ? '?action=home' : '?action=post&amp;id=' . $model-&gt;post-&gt;id ); ?&gt;&quot; class=&quot;btn btn-secondary&quot;&gt;Cancel&lt;/a&gt;
            &lt;/div&gt;
        &lt;/form&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;?php include('./views/shared/footer.php'); ?&gt;</pre></code>
            <figcaption>The post add/edit form view</figcaption>
        </figure>
        <figure>
            <code><pre>class CommentDB {
    private const BASE_QUERY = '
        SELECT
            Comments.id,
            Comments.content,
            Comments.creationDate,
            Comments.postId,
            Users.id userId,
            Users.name userName,
            Users.isAdmin userIsAdmin,
            Users.isGhost userIsGhost
        FROM Comments
            JOIN Users ON Comments.userId = Users.id
    ';

    // Convert a SQL result row to a comment object
    public static function convertRowToComment($row) {
        return new Comment(
            $row['id'],
            $row['content'],
            new DateTime($row['creationDate']),
            $row['postId'],
            null,
            $row['userId'],
            new User(
                $row['userId'],
                $row['userName'],
                '',
                $row['userIsAdmin'],
                $row['userIsGhost']
            )
        );
    }

    // Convert SQL result rows to a list of comment objects
    public static function convertRowsToComments($rows) {
        $comments = [];
        foreach ($rows as $row) {
            $comments[] = self::convertRowToComment($row);
        }
        return $comments;
    }

    // Get a comment by its id
    public static function getComment(int $id) {
        $query = self::BASE_QUERY . 'WHERE Comments.id = :id';
        $rows = Database::execute($query, [':id' => $id]);
        if (count($rows) == 0) return null;
        return self::convertRowToComment($rows[0]);
    }</pre></code>
            <figcaption>A snippet of the data layer code that handles comments</figcaption>
        </figure>
        <figure>
            <code><pre>&lt;?php
/**
* Title: Home Controller
* Purpose: To display the home page, forums and forum pages, and users and user pages
*/

require_once('./models/viewModels/homeViewModel.php');
require_once('./models/viewModels/forumsViewModel.php');
require_once('./models/viewModels/forumViewModel.php');
require_once('./models/viewModels/usersViewModel.php');
require_once('./models/viewModels/userViewModel.php');
require_once('./models/viewModels/postViewModel.php');

// Display the home page with recent posts from all forums
if ($action == 'home' &amp;&amp; $isGetRequest) {
    $model = new HomeViewModel(PostDB::getRecentPosts(), $currentUser);
    include('./views/home/home.php');
    exit();
}

// Display the list of all forums
if ($action == 'forums' &amp;&amp; $isGetRequest) {
    $model = new ForumsViewModel(ForumDB::getForums(), $currentUser);
    include('./views/home/forums.php');
    exit();
}

// Display posts within a given forum
if ($action == 'forum' &amp;&amp; $isGetRequest) {
    $id = FILTER_INPUT(INPUT_GET, 'id', FILTER_VALIDATE_INT);
    $forum = getObjectOr404('forum', $id);
    $model = new ForumViewModel($forum, $currentUser);
    include('./views/home/forum.php');
    exit();
}

// Display the list of all users
if ($action == 'users' &amp;&amp; $isGetRequest) {
    $model = new UsersViewModel(UserDB::getUsers(), $currentUser);
    include('./views/home/users.php');
    exit();
}

// Display a single user and all their posts or comments
if ($action == 'user' &amp;&amp; $isGetRequest) {
    $id = FILTER_INPUT(INPUT_GET, 'id', FILTER_VALIDATE_INT);
    $user = getObjectOr404('user', $id);

    if ($user-&gt;isGhost) {
        return404();
    }

    $mode = FILTER_INPUT(INPUT_GET, 'mode');
    if ($mode === null) {
        $mode = 'posts';
    } else if ($mode !== 'posts' &amp;&amp; $mode !== 'comments') {
        return404();
    }

    $posts = [];
    $comments = [];
    if ($mode == 'posts') {
        $posts = PostDB::getUserPosts($id);
    } else {
        $comments = CommentDB::getUserComments($id);
    }

    $model = new UserViewModel($user, $mode, $posts, $comments, $currentUser);
    include('./views/home/user.php');
    exit();
}

?&gt;</pre></code>
            <figcaption>The home controller</figcaption>
        </figure>
    </main>
    <footer class="footer">
        &copy; 2025 Luke Hamann
    </footer>
    <a href="#" class="back-to-top">&uparrow; Top</a>
</body>
</html>
